const UserAPIV2="API/V2/User.php",BookAPIV2="API/V2/Book.php",AuthorAPIV2="API/V2/Author.php";var HideFunctions=[EmptyBorrowBook],ShowFunctions=[];function AddCard(t){document.getElementById("ContentBody").appendChild(t)}function CreateCard(t,e,o,n="dark",r="",i=""){var d=document.createElement("div");return d.classList+="card card-"+n+" "+e,d.id=t,d.innerHTML='<div class="card-header" id="Card-'+t+'Header"><h3 class="card-title">'+o+'</h3></div><div class="card-body" id="'+t+'Body">'+r+'</div><div class="card-footer" id="'+t+'Footer">'+i+"</div>",d}function AddNotification(t){document.getElementById("NotificationNumber").innerText=parseInt(document.getElementById("NotificationNumber").innerText)+1,document.getElementById("NotificationNumberNotifications").innerText=parseInt(document.getElementById("NotificationNumber").innerText)+" "+document.getElementById("NotificationNumberNotifications").innerText.split(" ",2)[1],document.getElementById("NotificationDropDown").appendChild(t);var e=document.createElement("div");e.classList="dropdown-divider",document.getElementById("NotificationDropDown").appendChild(e)}function CreateNotification(t,e,o,n){var r=document.createElement("a");return r.href=e,r.id="Notification-"+t,r.classList="dropdown-item",r.innerHTML='<i class="fas '+o+' mr-2"></i>'+n,r}function ReloadView(){for(var t=ContentBody.children,e=0;e<t.length;e++)t[e].style.display="none";for(e=0;e<HideFunctions.length;e++)HideFunctions[e]();const o=document.getElementsByClassName(location.hash.substring(1));for(e=0;e<o.length;e++)o[e].style.display="block";for(e=0;e<ShowFunctions.length;e++)ShowFunctions[e]()}function GetAuthors(t,e,o=!1){console.log(t);for(var n=0;n<t.length;n++)$.post(AuthorAPIV2,{type:"GetAuthor",Identifier:t[n]},function(t){console.log(t),0==o?e.innerText+=t.data.Name+" - ":e.innerHTML+='<a href="#'+t.data.Name+'">'+t.data.Name+"</a>"})}var BorrowBookIdentifier,BorrowBookFindBookBtn,BorrowBookListNumber=1;function BorrowBookFindBook(){BorrowBookIdentifier.value.length<3||$.post(BookAPIV2,{type:"GetBook",Identifier:BorrowBookIdentifier.value},function(t){var e=document.getElementById("BorrowingTable").children[1],o=e.insertRow(e.rows.length);o.insertCell(0).innerText=BorrowBookListNumber++,o.insertCell(1).innerText=t.data.Identifier,o.insertCell(2).innerText=t.data.Title,GetAuthors(JSON.parse(t.data.AuthorIDs),o.insertCell(3),!1),o.insertCell(4).innerText="Cancel",BorrowBookIdentifier.value=""})}function EmptyBorrowBook(){$("#BorrowingTable tbody tr").remove(),BorrowBookIdentifier.value=""}function LogOut(){$.post(UserAPIV2,{type:"LogOut"},function(t){location.reload()})}function SearchBooks(){var t=document.getElementById("SearchBookInput").value;return $.post(BookAPIV2,{type:"SearchBook",SearchTag:t},function(t){if(t.response){var e=document.getElementById("SearchResultTable").children[1];e.innerHTML="";for(var o=0;o<t.data.length;o++){var n=e.insertRow(e.rows.length);n.insertCell(0).innerText=o+1,n.insertCell(1).innerText=t.data[o].Identifier,n.insertCell(2).innerText=t.data[o].Title,GetAuthors(JSON.parse(t.data[o].AuthorIDs),n.insertCell(3),!1),n.insertCell(4).innerText=t.data[o].Dewey,n.insertCell(5).innerText=t.data[o].ISBN,n.insertCell(6).innerText=t.data[o].Quantity-t.data[o].QuantityBorrowed}location.hash="#Search"}else console.log("Could not perform the Search")}),!1}$(function(){AddCard(CreateCard("BorrowBookCard","BorrowBook","Borrow Book","dark",'<div class="row"><div class="col-9"> <input type="text" class="form-control" id="BorrowBookIdentifier" placeholder="Book Identifier"></div><div class="col-3"> <button type="button" class="btn btn-block btn-dark" id="BorrowBookFindBookBtn">Find Book</button></div></div> <br /><div class="row"><div class="col-12 table-responsive"><table id="BorrowingTable" class="table table-bordered table-striped"><thead><tr><th>#</th><th>Identifier</th><th>Title</th><th>Author</th><th>Action</th></tr></thead><tbody></tbody></table></div></div> <br /><div class="row"><div class="col-9"> <input type="text" class="form-control" placeholder="User Identifier"></div><div class="col-3"> <button type="button" class="btn btn-block btn-dark">Find User</button></div></div> <br /><div class="row"><div class="col-12"> <input type="text" class="form-control" placeholder="User Name" readonly disabled></div></div>','<button type="button" class="btn btn-block btn-dark" id="BorrowBookBtn" style="width: 100%">Charge</button>')),AddCard(CreateCard("ReturnBookCard","ReturnBook","Return Book","dark",'<div class="row"><div class="col-9"> <input type="text" class="form-control" placeholder="Book Identifier"></div><div class="col-3"> <button type="button" class="btn btn-block btn-dark">Find Book</button></div></div> <br /><div class="row"><div class="col-12 table-responsive"><table id="BorrowingTable" class="table table-bordered table-striped"><thead><tr><th>#</th><th>Identifier</th><th>Title</th><th>Author</th><th>Action</th></tr></thead><tbody></tbody></table></div></div>','<button type="button" class="btn btn-block btn-dark" style="width: 100%">Return Books</button>')),AddCard(CreateCard("SearchResultsCard","Search","Search Results","dark",'<div class="col-12 table-responsive"><table id="SearchResultTable" class="table table-bordered table-striped"><thead><tr><th>#</th><th>Identifier</th><th>Title</th><th>Author</th><th>Dewey</th><th>ISBN</th><th>Quantity Available</th></tr></thead><tbody></tbody></table></div>',"")),BorrowBookIdentifier=document.getElementById("BorrowBookIdentifier"),BorrowBookFindBookBtn=document.getElementById("BorrowBookFindBookBtn"),window.addEventListener("hashchange",ReloadView,!1),ReloadView(),BorrowBookFindBookBtn.onclick=BorrowBookFindBook});