const UserAPIV2="API/V2/User.php",BookAPIV2="API/V2/Book.php",AuthorAPIV2="API/V2/Author.php";var HideFunctions=[],ShowFunctions=[];function AddCard(e){document.getElementById("ContentBody").appendChild(e)}function CreateCard(e,t,a,n="dark",o="",r=""){var s=document.createElement("div");return s.classList+="card card-"+n+" "+t,s.id=e,s.innerHTML='<div class="card-header" id="Card-'+e+'Header"><h3 class="card-title">'+a+'</h3></div><div class="card-body" id="'+e+'Body">'+o+'</div><div class="card-footer" id="'+e+'Footer">'+r+"</div>",s}function ReloadView(){for(var e=ContentBody.children,t=0;t<e.length;t++)e[t].style.display="none";for(t=0;t<HideFunctions.length;t++)HideFunctions[t]();const a=document.getElementsByClassName(location.hash.substring(1));for(t=0;t<a.length;t++)a[t].style.display="block";for(t=0;t<ShowFunctions.length;t++)ShowFunctions[t]()}function GetAuthors(e,t,a=!1){for(var n=0;n<e.length;n++)$.post(AuthorAPIV2,{type:"GetAuthor",Identifier:e[n]},function(e){0==a?t.innerText+=e.data.Name+" - ":t.innerHTML+='<a href="#'+e.data.Name+'">'+e.data.Name+"</a>"})}function LogIn(){var e=document.getElementById("UsernameInput").value,t=document.getElementById("PasswordInput").value;$.post(UserAPIV2,{type:"GetAlgo",Username:e},function(a){if(a.response)if(a.data.hasOwnProperty("Algo")&&null!=a.data.Algo&&""!=a.data.Algo){switch(a.data.Algo){case"sha256":t=sha256(t);break;case"sha512":t=sha512(t);break;default:return void console.log("User is not login capable")}$.post(UserAPIV2,{type:"LogIn",Username:e,Password:t},function(e){e.response?location.reload():console.log("Wrong Credentials")})}else console.log("User is not login capable.");else console.log("Error getting Hashing Algorythm")})}function SearchBooks(){var e=document.getElementById("SearchBookInput").value;return $.post(BookAPIV2,{type:"SearchBook",SearchTag:e},function(e){if(e.response){var t=document.getElementById("SearchResultTable").children[1];t.innerHTML="";for(var a=0;a<e.data.length;a++){var n=t.insertRow(t.rows.length);n.insertCell(0).innerText=a+1,n.insertCell(1).innerText=e.data[a].Identifier,n.insertCell(2).innerText=e.data[a].Title,GetAuthors(JSON.parse(e.data[a].AuthorIDs),n.insertCell(3),!1),n.insertCell(4).innerText=e.data[a].Dewey,n.insertCell(5).innerText=e.data[a].ISBN,n.insertCell(6).innerText=e.data[a].Quantity-e.data[a].QuantityBorrowed}location.hash="#Search"}else console.log("Could not perform the Search")}),!1}$(function(){AddCard(CreateCard("LogInCard","Login","Log In","dark",'<div class="row"><div class="col-12"><input type="text" class="form-control" id="UsernameInput" placeholder="Username"></div></div><br /><div class="row"><div class="col-12"><input type="password" class="form-control" id="PasswordInput" placeholder="Password"></div></div>','<button type="button" class="btn btn-block btn-dark" onclick="LogIn();" style="width: 100%">Login</button>')),AddCard(CreateCard("SearchResultsCard","Search","Search Results","dark",'<div class="col-12 table-responsive"><table id="SearchResultTable" class="table table-bordered table-striped"><thead><tr><th>#</th><th>Identifier</th><th>Title</th><th>Author</th><th>Dewey</th><th>ISBN</th><th>Quantity Available</th></tr></thead><tbody></tbody></table></div>',"")),window.addEventListener("hashchange",ReloadView,!1),ReloadView()});