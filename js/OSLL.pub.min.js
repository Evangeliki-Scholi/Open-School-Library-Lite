const UserAPIV2="API/V2/User.php",BookAPIV2="API/V2/Book.php",AuthorAPIV2="API/V2/Author.php";var HideFunctions=[],ShowFunctions=[ShowAuthor];function AddCard(t){document.getElementById("ContentBody").appendChild(t)}function CreateCard(t,e,o,a="dark",r="",n=""){var i=document.createElement("div");return i.classList+="card card-"+a+" "+e,i.id=t,i.innerHTML='<div class="card-header" id="Card-'+t+'Header"><h3 class="card-title">'+o+'</h3></div><div class="card-body" id="'+t+'Body">'+r+'</div><div class="card-footer" id="'+t+'Footer">'+n+"</div>",i}function ReloadView(){for(var t=ContentBody.children,e=0;e<t.length;e++)t[e].style.display="none";for(e=0;e<HideFunctions.length;e++)HideFunctions[e]();const o=document.getElementsByClassName(location.hash.substring(1));for(e=0;e<o.length;e++)o[e].style.display="block";for(e=0;e<ShowFunctions.length;e++)ShowFunctions[e]()}function GetAuthors(t,e,o=!1){for(var a=0;a<t.length;a++)$.post(AuthorAPIV2,{type:"GetAuthor",Identifier:t[a]},function(t){0==o?e.innerText+=t.data.Name+" - ":e.innerHTML+='<a href="#Author" onclick="AuthorID='+t.data.ID+'">'+t.data.Name+"</a>"})}function LogIn(){var t=document.getElementById("UsernameInput").value,e=document.getElementById("PasswordInput").value;$.post(UserAPIV2,{type:"GetAlgo",Username:t},function(o){if(o.response)if(o.data.hasOwnProperty("Algo")&&null!=o.data.Algo&&""!=o.data.Algo){switch(o.data.Algo){case"sha256":e=sha256(e);break;case"sha512":e=sha512(e);break;default:return void console.log("User is not login capable")}$.post(UserAPIV2,{type:"LogIn",Username:t,Password:e},function(t){t.response?location.reload():console.log("Wrong Credentials")})}else console.log("User is not login capable.");else console.log("Error getting Hashing Algorythm")})}var SkipSearch=0;function SearchBooks(){var t=document.getElementById("SearchBookInput").value;return $.post(BookAPIV2,{type:"SearchBook",SearchTag:t,Skip:SkipSearch},function(t){if(t.response){var e=document.getElementById("SearchResultTable").children[1];e.innerHTML="";for(var o=0;o<t.data.length;o++){var a=e.insertRow(e.rows.length);a.insertCell(0).innerText=SkipSearch+o+1,a.insertCell(1).innerText=t.data[o].Identifier,a.insertCell(2).innerText=t.data[o].Title,GetAuthors(JSON.parse(t.data[o].AuthorIDs),a.insertCell(3),!0),a.insertCell(4).innerText=t.data[o].Dewey,a.insertCell(5).innerText=t.data[o].ISBN,a.insertCell(6).innerText=t.data[o].Quantity-t.data[o].QuantityBorrowed}location.hash="#Search"}else console.log("Could not perform the Search")}),!1}var AuthorID=-1;function ShowAuthor(){"#Author"==location.hash&&(-1==AuthorID&&(location.hash=""),$.post(AuthorAPIV2,{type:"GetAuthor",Identifier:AuthorID},function(t){document.getElementById("AuthorName").innerText=t.data.Name,null!=t.data.PictureURL?(document.getElementById("AuthorPictureImg").style.display="block",document.getElementById("AuthorPictureImg").src=t.data.PictureURL):document.getElementById("AuthorPictureImg").style.display="none",document.getElementById("AuthorDescription").innerText=""!=t.data.Description?t.data.Description:"No Author Description"}))}$(function(){AddCard(CreateCard("LogInCard","Login","Log In","dark",'<div class="row"><div class="col-12"><input type="text" class="form-control" id="UsernameInput" placeholder="Username" autocomplete="off" readonly onfocus="this.removeAttribute(\'readonly\');"></div></div><br /><div class="row"><div class="col-12"><input type="password" class="form-control" id="PasswordInput" placeholder="Password" autocomplete="off" readonly onfocus="this.removeAttribute(\'readonly\');"></div></div>','<button type="button" class="btn btn-block btn-dark" onclick="LogIn();" style="width: 100%">Login</button>')),AddCard(CreateCard("SearchResultsCard","Search","Search Results","dark",'<div class="col-12 table-responsive"><table id="SearchResultTable" class="table table-bordered table-striped"><thead><tr><th>#</th><th>Identifier</th><th>Title</th><th>Author</th><th>Dewey</th><th>ISBN</th><th>Quantity Available</th></tr></thead><tbody></tbody></table></div>','<div class="row"><div class="col-6"><button type="button" class="btn btn-block btn-primary" onclick="if (SkipSearch >= 20) { SkipSearch = SkipSearch - 20; SearchBooks(); }">Previous Page</button></div><div class="col-6"><button type="button" class="btn btn-block btn-primary" onclick="SkipSearch = SkipSearch + 20; SearchBooks();">Next Page</button></div></div>')),AddCard(CreateCard("AuthorCard","Author","Author's Page","dark",'<div class="row"><div class="col-12"><h1 id="AuthorName" style="text-align: center;"></h1></div></div><div class="row"><div class="col-12"><img src="" id="AuthorPictureImg" width="30%" style="margin-left: auto; margin-right: auto;"></div></div><br /><div class="row"><div class="col-12"><p id="AuthorDescription" class="text-justify"></p></div></div>',"")),window.addEventListener("hashchange",ReloadView,!1),ReloadView()});